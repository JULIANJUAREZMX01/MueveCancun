## 2025-05-22 - [Mapbox Optimization & Regression Prevention]
**Learning:** Adding dependencies to a useEffect cleanup function that calls destructive methods (like `map.remove()`) will cause the entire component to be destroyed and recreated whenever those dependencies change, even if the effect logic itself has a guard. This is because React calls the cleanup of the previous effect before running the new one.
**Action:** Use an empty dependency array `[]` for initialization effects with cleanup. If you need to satisfy the linter for variables used during initialization, use a ref (`useRef`) to store those values stably. Perform updates in separate effects using imperative API calls.
