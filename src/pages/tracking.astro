---
import MainLayout from '../layouts/MainLayout.astro';
---

<MainLayout title="Tracking - CancúnMueve">
	<div class="tracking-page">
		<!-- Header -->
		<header class="tracking-header">
			<button class="back-btn" onclick="history.back()" aria-label="Go back">
				<svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
			</button>
			<div class="header-info">
				<h1 class="route-title">Ruta 12</h1>
				<p class="route-subtitle">Zona Hotelera - Centro</p>
			</div>
			<div class="spacer"></div>
		</header>

		<!-- Live Bus Pin (Overlay on Map) -->
		<div class="map-overlay">
			<!-- Bus Pin -->
			<div class="bus-pin-container animate-float">
				<div class="bus-pin">
					<svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4S4 2.5 4 6v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"/></svg>
				</div>
				<div class="pulse-ring"></div>
				<div class="pin-shadow"></div>
			</div>

			<!-- Route Path (SVG Placeholder) -->
			<!-- In a real app, this would be drawn on the map canvas -->
		</div>

		<!-- QR Sheet -->
		<div class="qr-sheet glass-panel animate-slide-up">
			<div class="sheet-handle"></div>

			<div class="qr-content">
				<div class="qr-header">
					<h2 class="qr-title">Pase de Abordar</h2>
					<div class="live-badge">
						<div class="live-dot animate-pulse"></div>
						<span>VÁLIDO</span>
					</div>
				</div>

				<div class="qr-code-container">
					<!-- CSS/HTML Simulated QR Code -->
					<div class="qr-placeholder">
						<svg class="w-24 h-24 text-slate-800" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M3 11h8V3H3v8zm2-6h4v4H5V5zM3 21h8v-8H3v8zm2-6h4v4H5v-4zM13 3v8h8V3h-8zm6 6h-4V5h4v4zM19 19h2v2h-2zM13 13h2v2h-2zM15 15h2v2h-2zM13 17h2v2h-2zM15 19h2v2h-2zM17 17h2v2h-2zM17 13h2v2h-2zM19 15h2v2h-2z"/></svg>
					</div>
				</div>

				<p class="scan-instruction">Escanea al subir al autobús</p>

				<div class="trip-details">
					<div class="detail-item">
						<span class="label">Unidad</span>
						<span class="value">402</span>
					</div>
					<div class="detail-item">
						<span class="label">Tarifa</span>
						<span class="value">$12.00</span>
					</div>
					<div class="detail-item">
						<span class="label">Llegada</span>
						<span class="value highlight">2 min</span>
					</div>
				</div>
			</div>
		</div>
	</div>
</MainLayout>

<style>
	.tracking-page {
		position: relative;
		height: 100vh;
		width: 100%;
		overflow: hidden;
		display: flex;
		flex-direction: column;
		justify-content: space-between;
	}

	/* Header */
	.tracking-header {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		z-index: 20;
		display: flex;
		align-items: center;
		justify-content: space-between;
		padding: 3.5rem 1.5rem 1rem 1.5rem;
		background: linear-gradient(to bottom, rgba(0,0,0,0.4), transparent);
	}

	.back-btn {
		width: 2.5rem;
		height: 2.5rem;
		background-color: white;
		border-radius: 50%;
		border: none;
		display: flex;
		align-items: center;
		justify-content: center;
		box-shadow: 0 4px 6px rgba(0,0,0,0.1);
		cursor: pointer;
		color: var(--text-primary);
	}

	.header-info {
		text-align: center;
		color: white;
		text-shadow: 0 2px 4px rgba(0,0,0,0.3);
	}

	.route-title {
		margin: 0;
		font-size: 1.25rem;
		font-weight: 800;
	}

	.route-subtitle {
		margin: 0;
		font-size: 0.75rem;
		font-weight: 500;
		opacity: 0.9;
	}

	.spacer {
		width: 2.5rem;
	}

	/* Map Overlay */
	.map-overlay {
		flex: 1;
		position: relative;
		pointer-events: none;
	}

	.bus-pin-container {
		position: absolute;
		top: 40%;
		left: 50%;
		transform: translate(-50%, -50%);
		display: flex;
		flex-direction: column;
		align-items: center;
	}

	.bus-pin {
		width: 3.5rem;
		height: 3.5rem;
		background-color: var(--color-primary);
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		color: white;
		font-size: 2rem;
		box-shadow: 0 10px 25px rgba(0, 169, 224, 0.4);
		z-index: 2;
		border: 3px solid white;
	}

	.bus-pin span {
		font-size: 2rem;
	}

	.pulse-ring {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		width: 3.5rem;
		height: 3.5rem;
		background-color: var(--color-primary);
		border-radius: 50%;
		z-index: 1;
		animation: ping 2s cubic-bezier(0, 0, 0.2, 1) infinite;
		opacity: 0.5;
	}

	.pin-shadow {
		width: 2rem;
		height: 0.5rem;
		background-color: rgba(0,0,0,0.3);
		border-radius: 50%;
		margin-top: 1rem;
		filter: blur(4px);
	}

	/* QR Sheet */
	.qr-sheet {
		background: white;
		border-top-left-radius: 1.5rem;
		border-top-right-radius: 1.5rem;
		padding: 1.5rem;
		box-shadow: 0 -10px 40px rgba(0,0,0,0.1);
		z-index: 30;
		margin: 0 1rem 1rem 1rem;
	}

	.glass-panel {
		background: rgba(255, 255, 255, 0.9);
		backdrop-filter: blur(16px);
		border: 1px solid rgba(255, 255, 255, 0.8);
	}

	.sheet-handle {
		width: 3rem;
		height: 0.25rem;
		background-color: var(--border-light, #E2E8F0);
		border-radius: 9999px;
		margin: 0 auto 1.5rem auto;
	}

	.qr-content {
		display: flex;
		flex-direction: column;
		align-items: center;
	}

	.qr-header {
		width: 100%;
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 1.5rem;
	}

	.qr-title {
		margin: 0;
		font-size: 1.125rem;
		font-weight: 700;
		color: var(--text-primary);
	}

	.live-badge {
		background-color: rgb(220 252 231); /* emerald-100 */
		color: rgb(22 101 52); /* green-800 */
		padding: 0.25rem 0.5rem;
		border-radius: 0.5rem;
		font-size: 0.625rem;
		font-weight: 800;
		letter-spacing: 0.05em;
		display: flex;
		align-items: center;
		gap: 0.375rem;
	}

	.live-dot {
		width: 0.375rem;
		height: 0.375rem;
		background-color: rgb(22 101 52); /* green-800 */
		border-radius: 50%;
	}

	.qr-code-container {
		background-color: white;
		padding: 1rem;
		border-radius: 1rem;
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
		margin-bottom: 1rem;
		border: 2px dashed var(--border-light, #CBD5E1);
	}

	.qr-placeholder {
		width: 10rem;
		height: 10rem;
		display: flex;
		align-items: center;
		justify-content: center;
		background-color: var(--surface-secondary, #F8FAFC);
	}

	.qr-icon {
		font-size: 6rem;
		color: var(--text-primary);
	}

	.scan-instruction {
		font-size: 0.875rem;
		color: var(--text-secondary);
		margin-bottom: 1.5rem;
		font-weight: 500;
	}

	.trip-details {
		width: 100%;
		display: flex;
		justify-content: space-between;
		padding-top: 1.5rem;
		border-top: 1px solid var(--border-light, #E2E8F0);
	}

	.detail-item {
		display: flex;
		flex-direction: column;
		align-items: center;
	}

	.label {
		font-size: 0.75rem;
		color: var(--text-secondary);
		text-transform: uppercase;
		font-weight: 600;
		margin-bottom: 0.25rem;
	}

	.value {
		font-size: 1.125rem;
		font-weight: 700;
		color: var(--text-primary);
	}

	.value.highlight {
		color: var(--color-secondary);
	}

	/* Animations */
	@keyframes float {
		0%, 100% { transform: translate(-50%, -50%); }
		50% { transform: translate(-50%, -60%); }
	}

	.animate-float {
		animation: float 3s ease-in-out infinite;
	}

	@keyframes ping {
		75%, 100% {
			transform: translate(-50%, -50%) scale(2);
			opacity: 0;
		}
	}

	@keyframes pulse {
		50% { opacity: .5; }
	}

	.animate-pulse {
		animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
	}

	@keyframes slide-up {
		from { transform: translateY(100%); opacity: 0; }
		to { transform: translateY(0); opacity: 1; }
	}

	.animate-slide-up {
		animation: slide-up 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
	}
</style>
